# 📋 SmolVLM 本地推理方案弃用 - 变更总结

## 变更日期
2025-12-06

## 变更背景

经过测试发现，即使是 256M 参数的轻量级模型（SmolVLM-256M-Instruct），在普通 i7 CPU 上的推理时间也达到了 **30+ 秒/次**，这对用户体验来说是**完全不合理的**。

因此做出战略性调整：**完全弃用本地大模型推理方案，转而采用 URL 调用云 AI 服务**。

---

## 具体变更

### ✅ 前端部分

**文件：** `frontend/src/pages/AppHome.tsx`

**变更内容：**
- 添加 `useEffect` 钩子，在页面加载时检查 AI 配置
- 集成 `getAIConfig()` 检查视觉模型和文生图模型配置状态
- 当 **未配置任何 AI 服务** 时，显示警告弹窗
- 弹窗内容包括：
  - ⚠️ 配置状态提示
  - 📝 使用百度 AI Studio 的建议
  - 🔗 直接链接到百度 AI Studio 官网
  - "去配置"按钮导航到 ConfigAI 页面

**用户体验流程：**
```
打开应用 → 检测 AI 配置 → 未配置 → 显示弹窗 → 用户选择配置 → 导航到 ConfigAI
```

### 📚 文档部分

**文件 1：** `README.md`

**变更内容：**
- 在"项目介绍"后添加"⚡ 快速开始"章节
- 添加指向 AI 配置快速指南的链接
- 重写"⚙️ 配置说明"部分，新增"🔴 重要：AI 服务配置"子章节
- 详细说明：
  - 为什么不内置大模型（性能和用户体验）
  - 推荐配置方案（百度飞桨 AI Studio）
  - 其他云服务选项
  - 配置步骤（3 步）

**文件 2：** `docs/AI_CONFIG_GUIDE.md` (新建)

**内容：**
完整的"AI 配置快速指南"，包括：
- 三步快速配置流程
- 百度 AI Studio 注册指南
- 视觉模型和文生图模型配置表
- 常见问题解答 (Q&A)
- 免费额度说明
- 其他 AI 服务选项

**文件 3：** `labs/README_DEPRECATED.md` (新建)

**内容：**
- 说明 SmolVLM 方案弃用原因
- 列出已弃用的文件
- 推荐云服务方案

---

## 已弃用但保留的文件

出于参考价值，以下文件保留但**不再使用**：

- `labs/smolvlm_server.py` - SmolVLM 推理服务（已过时）
- `labs/start_smolvlm.py` - 启动脚本（已过时）  
- `labs/requirements.txt` - 依赖文件已更新（移除 llama-cpp-python[server]）

## 应该删除的文件（可选）

如果要彻底清理，可删除：
- `labs/smolvlm_server.py`
- `labs/start_smolvlm.py`

---

## 核心优势对比

| 方面 | 本地 SmolVLM | 云 AI 服务（推荐） |
|-----|-----------|--------------|
| **推理速度** | 30+ 秒 | < 1 秒 |
| **准确度** | 中等 | 很高 |
| **成本** | 高（电费/服务器） | 低（免费额度） |
| **用户体验** | 差（等待时间长） | 优（即时响应） |
| **维护成本** | 高 | 低 |
| **可扩展性** | 低 | 高 |

---

## 用户迁移指南

### 对于已有配置的用户

无需任何操作！已有的 AI 配置会继续正常工作。

### 对于新用户

1. 启动应用后，主页会自动提醒配置 AI 服务
2. 按照弹窗提示 3 分钟完成配置
3. 开始使用所有 AI 功能

### 对于开发者

如果使用了本地推理方案的代码：
- 参考新的弹窗实现方式了解配置检查逻辑
- 查看 `AppHome.tsx` 的 `useEffect` 钩子实现
- 查看 `AI_CONFIG_GUIDE.md` 了解完整配置流程

---

## 测试清单

- [ ] 打开应用主页，确认弹窗正确显示
- [ ] 未配置时弹窗提醒
- [ ] 点击"去配置"按钮导航到 ConfigAI
- [ ] 填写 AI 配置后，再次打开主页不显示弹窗
- [ ] 测试"测试视觉模型"功能
- [ ] 测试"测试文生图模型"功能
- [ ] 验证绘画猜词功能
- [ ] 验证 AI 画你猜功能

---

## 后续计划

- [ ] 支持更多云服务集成（OpenAI、Claude、阿里通义等）
- [ ] 实现请求缓存和去重
- [ ] 添加 API 调用统计和成本预估
- [ ] 实现本地离线模式（可选功能）
- [ ] 优化 Token 使用效率

---

## 参考资源

- 📖 [项目主 README](../README.md)
- 🚀 [AI 配置快速指南](../docs/AI_CONFIG_GUIDE.md)
- ⚠️ [SmolVLM 弃用说明](./README_DEPRECATED.md)
- 🔗 [百度 AI Studio](https://aistudio.baidu.com)
